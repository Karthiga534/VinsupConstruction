{% extends "base.html" %}

{% load static %}

{% block header2 %}

<style>
    /* Basic styles for logos */
    .logo-container {
        display: flex;
        flex-wrap: wrap;
    }
    .logo-item {
        margin: 10px;
        padding: 20px;
        border: 1px solid #ddd;
        width: 200px;
        text-align: center;
    }
</style>


<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="mb-sm-0">Dashboard </h4>
                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item">
                                    <a href="javascript: void(0);">Dashboards</a>
                                </li>
                                <li class="breadcrumb-item active">Entry</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xxl-12">
                    <div class="d-flex flex-column h-100">
                        <div class="row h-100">

                            <!-- end col-->
                        </div>
                        <!-- end row-->
                        <div class="row">
                            
                            <div class="col-md-3">
                                <a href="{% url 'project' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Total Projects</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="project_count">{{ project_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-success mb-0">
                                                        <i class="ri-arrow-up-line align-middle"></i>

                                                        {{ previous_month_project_count }} </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-primary rounded-circle fs-2">
                                                        <i data-feather="users"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                <!-- end card-->
                            </a>
                            </div>
                            



                            <!-- end col-->
                            <div class="col-md-3">
                                <a href="{% url 'project_filtered' 'ongoing' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Ongoing Projects</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="project_count">{{ ongoing_project_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-danger mb-0">
                                                        <i class="ri-arrow-down-line align-middle"></i>
                                                        {{ previous_month_ongoing_project_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-danger rounded-circle fs-2">
                                                        <i data-feather="activity"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                <!-- end card-->
                            </a>
                            </div>
                            <!-- end col-->

                            <div class="col-md-3">
                                <a href="{% url 'project_filtered' 'completed' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Completed Projects</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="project_count">{{ completed_project_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-danger mb-0">
                                                        <i class="ri-arrow-down-line align-middle"></i>
                                                        {{ previous_month_completed_project_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-danger rounded-circle fs-2">
                                                        <i data-feather="activity"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                <!-- end card-->
                            </a>
                            </div>
                            <!-- end col-->




                            <div class="col-md-3">
                                <a href="{% url 'contractor' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Contractors</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="contractor-count">{{ contractor_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-success mb-0">
                                                        <i class="ri-arrow-up-line align-middle"></i>
                                                        {{ previous_month_contractor_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-success rounded-circle fs-2">
                                                        <i data-feather="external-link"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                </a>
                                <!-- end card-->

                            </div>
                            <!-- end col-->
                        </div>
                        <!-- end row-->
                        <div class="row">


                            <div class="col-md-3">
                                <a href="{% url 'quatationlist' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Purchase Request</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="quatation-count" data-target="">{{ quatation_count  }}</span>
                                                       
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-danger mb-0">
                                                        <i class="ri-arrow-down-line align-middle"></i>
                                                        {{ previous_month_quatation_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-danger rounded-circle fs-2">
                                                        <i data-feather="activity"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                <!-- end card-->
                                </a>    
                            </div>
                            <!-- end col-->

                            <div class="col-md-3">
                                <a href="{% url 'subcontractorlist' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Sub Contracts</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="projectsubcontract-count" data-target="">
                                                        {{ projectsubcontract_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-danger mb-0">
                                                        <i class="ri-arrow-down-line align-middle"></i>
                                                        {{ previous_month_projectsubcontract_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-danger rounded-circle fs-2">
                                                        <i data-feather="activity"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end card body -->
                                </div>
                                <!-- end card-->
                            </a>
                            </div>
                            <!-- end col-->


                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Pro Subcontract Attendance</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="attendance-count" >{{ proattendance_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_proattendance_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->

                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Vendor Registration</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="vendorregistration-count" >{{ vendorregistration_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_vendorregistration_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                        </div>

                                    </div> -->



                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Vendor Quatation</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="vendorquatation-count" >{{ vendorquatation_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_vendorquatation_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->

                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Purchase List</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="purchaselist-count" >{{ purchaselist_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_purchaselist_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div> -->



                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">UOM</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="uom-count" >{{ uom_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_uom_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->




                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Material Library</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="materiallibrary-count" >{{ materiallibrary_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_materiallibrary_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->


                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Machinary Charges</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="machinarycharges-count" >{{ machinarycharges_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_machinarycharges_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->

                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Labour Roles & Salary</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="labourrolesandsalary-count" >{{ labourrolesandsalary_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_labourrolesandsalary_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>

                                    </div> -->

                            <div class="col-md-3">
                                <a href="{% url 'labours' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Company Labour</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="companylabour-count">{{ companylabour_count }}</span>
                                                </h2>
                                                {% comment %} <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-success mb-0">
                                                        <i class="ri-arrow-up-line align-middle"></i>
                                                        {{ previous_month_companylabour_count }}
                                                    </span> vs. previous month
                                                </p> {% endcomment %}
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-success rounded-circle fs-2">
                                                        <i data-feather="external-link"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </a>

                            </div>



                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Inventory Stock Management</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="inventorystock-count" >{{ inventorystock_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_inventorystock_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->


<!-- 
                            <div class="col-md-3">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Expense</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="expense-count">{{ expense_count }}</span>
                                                </h2>
                                                <p class="mb-0 text-muted">
                                                    <span class="badge bg-light text-success mb-0">
                                                        <i class="ri-arrow-up-line align-middle"></i>
                                                        {{ previous_month_expense_count }}
                                                    </span> vs. previous month
                                                </p>
                                            </div>
                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-success rounded-circle fs-2">
                                                        <i data-feather="external-link"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> -->



                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Site Stock</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="sitestock-count" >{{ sitestock_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_sitestock_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->


                            <!-- <div class="col-md-3">
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <div>
                                                        <p class="fw-medium text-muted mb-0">Transfer List</p>
                                                        <h2 class="mt-4 ff-secondary fw-semibold">
                                                            <span id="transferlist-count" >{{ transferlist_count }}</span>
                                                        </h2>
                                                        <p class="mb-0 text-muted">
                                                            <span class="badge bg-light text-success mb-0">
                                                                    <i class="ri-arrow-up-line align-middle"></i>
                                                                    {{ previous_month_transferlist_count }}
                                                                </span> vs. previous month
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title bg-success rounded-circle fs-2">
                                                                    <i data-feather="external-link"></i>
                                                                </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->



                            <div class="col-md-3">
                                <a href="{% url 'employee' %}">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p class="fw-medium text-muted mb-0">Employee</p>
                                                <h2 class="mt-4 ff-secondary fw-semibold">
                                                    <span id="employee-count">{{ employee_count }}</span>
                                                </h2>
                                                <p class="mb-0 text-muted">
                                                    {% comment %} <span class="badge bg-light text-danger mb-0">
                                                        <i class="ri-arrow-down-line align-middle"></i>

                                                        {{ previous_month_employee_count }}
                                                    </span> vs. previous month {% endcomment %}
                                                </p>
                                            </div>

                                            <div>
                                                <div class="avatar-sm flex-shrink-0">
                                                    <span class="avatar-title bg-warning rounded-circle fs-2">
                                                        <i data-feather="clock"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            </div>

                            {% comment %} <div class="logo-container">
                                {% for logo in logos %}
                                    <div class="logo-item">
                                        <h2>{{ logo.name }}</h2>
                                        {% if logo.background_color %}
                                            <div style="width: 100%; height: 100px; background-color: {{ logo.background_color }};"></div>
                                        {% endif %}
                                        {% if logo.image %}
                                            <img src="{{ logo.image.url }}" alt="{{ logo.name }}" style="width: 100%; height: auto;">
                                        {% endif %}
                                        <!-- Edit Button -->
                                        <button onclick="openEditForm({{ logo.id }}, '{{ logo.name }}', '{{ logo.background_color }}', '{{ logo.image.url }}')">Edit</button>
                                    </div>
                                {% endfor %}
                            </div> {% endcomment %}
                            <div class="logo-container">
                                {% for logo in logos %}
                                    <div class="logo-item">
                                        <h2>{{ logo.name }}</h2>
                                        {% if logo.background_color %}
                                            <div style="width: 100%; height: 100px; background-color: {{ logo.background_color }};"></div>
                                        {% endif %}
                                        {% if logo.image %}
                                            <div class="image-container">
                                                <img src="{{ logo.image.url }}" alt="{{ logo.name }}">
                                                <!-- Edit Button as Camera Icon -->
                                                <button class="edit-button" onclick="openEditForm({{ logo.id }}, '{{ logo.name }}', '{{ logo.background_color }}', '{{ logo.image.url }}')">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                                        <path d="M0 0h24v24H0z" fill="none"/>
                                                        <path d="M12 7c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm7 11c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2h-4.34l-1.05-1.05L14 5h-4L7.39 3.56 6.34 4.61 5 3.27 3.27 5l2.33 2.33L6 8h2l1.61 1.61L9.66 10H5v8h14v-4c0 1.1.9 2 2 2zm-2-10c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-5 10H7v-2h5v2zm7-4H7v-2h10v2z"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        {% endif %}
                                    </div>
                                {% endfor %}
                            </div>
                        
                            <!-- Edit Form Modal -->
                            <div id="editForm" style="display:none;">
                                <h2>Edit Logo</h2>
                                <form id="editLogoForm" enctype="multipart/form-data"> <!-- Add enctype for file uploads -->
                                    <input type="hidden" id="logoId">
                                    <label for="image">Upload Image:</label>
                                    <input type="file" id="image_file" name="image_file"><br> <!-- File input for image upload -->
                                    <button type="button" onclick="submitEditForm()">Save Changes</button>
                                    <button type="button" onclick="closeEditForm()">Cancel</button>
                                </form>
                            </div>



                        </div>

                    </div>
                </div>

            </div>


        </div>

    </div>

</div>

</div>
<!-- END layout-wrapper -->



<!--start back-to-top-->
<button onclick="topFunction()" class="btn btn-danger btn-icon" id="back-to-top">
    <i class="ri-arrow-up-line"></i>
</button>
<!--end back-to-top-->
<!--preloader-->
<div id="preloader">
    <div id="status">
        <div class="spinner-border text-primary avatar-sm" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</div>

<script>
    function openEditForm(id, name, backgroundColor, imageUrl) {
        document.getElementById('logoId').value = id;
        document.getElementById('editForm').style.display = 'block';
    }

    function closeEditForm() {
        document.getElementById('editForm').style.display = 'none';
    }

    function submitEditForm() {
        const logoId = document.getElementById('logoId').value;
        const imageFile = document.getElementById('image_file').files[0];

        const formData = new FormData();
        if (imageFile) {
            formData.append('image', imageFile);
        }

        fetch(`logos/${logoId}/`, {
            method: 'PUT',
            headers: {
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.id) {
                alert('Logo updated successfully');
                location.reload();  // Refresh the page to show updated data
            } else {
                alert('Error updating logo');
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Function to get the CSRF token for safe POST requests
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

{% endblock header2 %}